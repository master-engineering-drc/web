<!DOCTYPE html>
<html lang="fr" class="h-full scroll-smooth">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Simulateur de consommation • MED</title>
  <meta name="description" content="Simulateur express pour estimer votre consommation et votre solution de backup.">

  <!-- Open Graph / SEO -->
  <link rel="canonical" href="https://master-engineering-drc.github.io/web/">
  <meta property="og:title" content="MED • Électricité & Solaire" />
  <meta property="og:description" content="Installations électriques fiables, solaires hybrides, maintenance et mise aux normes." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="image/og-cover.jpg" />
  <meta property="og:site_name" content="MED • Master Engineering DRC" />
  <meta name="robots" content="index,follow" />
  <meta name="theme-color" content="#012b52" />

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'media',
      theme: {
        extend: {
          colors: {
            brand: '#012b52',
            yellowBrand: '#DCC69C',
            ink: '#000000',
            muted: '#555555'
          },
          boxShadow: { card: '0 10px 30px rgba(0,0,0,0.08)' },
          borderRadius: { xl: '18px' }
        }
      }
    }
  </script>

  <!-- Mini CSS util pour le <dialog> -->
  <style>
    html{scroll-behavior:smooth}
    dialog.lightbox { border:none; border-radius:16px; padding:0; max-width:min(92vw,1000px); box-shadow:0 10px 30px rgba(0,0,0,.18) }
    dialog::backdrop { background:rgba(0,0,0,.6) }
    .scrollbar-thin::-webkit-scrollbar{height:6px}
    .scrollbar-thin::-webkit-scrollbar-thumb{background:rgba(0,0,0,.2); border-radius:9999px}
  </style>
</head>
<body class="h-full bg-white text-slate-800 dark:bg-slate-950 dark:text-slate-100">
  <div id="top"></div>

  <!-- Header injecté -->
  <div data-include="partials/header.html"></div>

  <!-- ===== Simulateurs ===== -->
  <section id="simulateur" class="py-14 sm:py-16 bg-brand text-slate-100">
    <div class="max-w-[1400px] mx-auto px-4">
      <div class="flex items-center justify-between gap-4 flex-wrap mb-4">
        <h2 class="text-2xl sm:text-3xl font-bold text-yellowBrand">Simulateurs simples</h2>
        <span class="bg-white text-brand border border-black px-3 py-1 rounded-full text-xs sm:text-sm font-semibold">
          Ajoutez vos appareils • Voir si ça passe • Estimez la durée
        </span>
      </div>

      <!-- Onglets -->
      <div class="overflow-x-auto scrollbar-thin -mx-2 px-2 mb-5" role="tablist" aria-label="Simulateurs">
        <div class="flex gap-2 whitespace-nowrap">
          <button class="sim-tab px-3 py-2 rounded-lg bg-white text-brand border border-black font-semibold shadow-card focus:outline-none focus-visible:ring-2 focus-visible:ring-yellowBrand/60"
                  data-target="#panel-grid" aria-selected="true">SNEL (compteur)</button>
          <button class="sim-tab px-3 py-2 rounded-lg bg-white/10 border border-white/30 text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-yellowBrand/60"
                  data-target="#panel-pv" aria-selected="false">Solaire (PV + batterie)</button>
          <button class="sim-tab px-3 py-2 rounded-lg bg-white/10 border border-white/30 text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-yellowBrand/60"
                  data-target="#panel-gen" aria-selected="false">Groupe électrogène</button>
        </div>
      </div>

      <!-- Aide courte -->
      <div class="rounded-xl border border-white/20 bg-white/10 p-4 sm:p-5 shadow-card mb-6">
        <p class="text-sm sm:text-base text-slate-100/90">
          1) Ajoutez vos équipements (nom + W + heures/jour si besoin). 
          <br>2) Regardez l’indicateur :
          <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded border bg-green-100/90 text-green-900 border-green-300">✅ OK</span>,
          <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded border bg-amber-100/90 text-amber-900 border-amber-300">⚠️ À surveiller</span>,
          <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded border bg-red-100/90 text-red-900 border-red-300">⛔ Dépassé</span>.
          <br>3) L’estimation de temps s’affiche automatiquement.
        </p>
      </div>

      <div class="grid gap-6">
        <!-- ===================== SNEL (compteur) ===================== -->
        <section id="panel-grid" class="sim-panel grid gap-4">
          <header class="flex items-center justify-between gap-3 flex-wrap">
            <h3 class="text-xl font-bold text-yellowBrand">SNEL — Durée d’un achat (kWh)</h3>
            <div id="grid_status" class="px-2 py-1 rounded border text-sm bg-white/10 border-white/30" aria-live="polite">—</div>
          </header>

          <div class="bg-white text-ink dark:bg-[#111827] dark:text-white rounded-xl border border-gray-200 dark:border-slate-700 p-5 shadow-card grid gap-4">
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3">
              <label class="grid gap-1">
                <span class="font-semibold">Achat énergie (kWh)</span>
                <input id="grid_kwh" type="number" value="3" min="0"
                       class="w-full p-3 rounded-lg border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-800">
              </label>
              <label class="grid gap-1">
                <span class="font-semibold">Tarif (CDF/kWh) <span class="opacity-60">(optionnel)</span></span>
                <input id="grid_tarif" type="number" step="0.01" placeholder="ex: 800"
                       class="w-full p-3 rounded-lg border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-800">
              </label>
              <div class="hidden lg:block"></div>
            </div>

            <!-- Catalogue rapide (vignettes) — SNEL -->
            <details class="rounded border border-gray-200/60 dark:border-slate-700 p-3">
              <summary class="cursor-pointer font-semibold">Catalogue rapide (vignettes)</summary>
              <div id="grid_catalog" class="mt-3 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 xl:grid-cols-5 gap-3"></div>
            </details>

            <!-- Tableau équipements GRID -->
            <div class="-mx-3 sm:mx-0 overflow-x-auto">
              <table class="min-w-[640px] w-full text-sm">
                <thead>
                  <tr class="text-left text-gray-600 dark:text-gray-300">
                    <th class="py-2">Équipement</th><th>W</th><th>h/j</th><th></th>
                  </tr>
                </thead>
                <tbody id="grid_rows"></tbody>
              </table>
            </div>

            <div class="flex flex-wrap gap-2">
              <button id="grid_add"
                class="inline-flex items-center justify-center px-3 py-2 rounded-lg font-semibold transition shadow-card
                       bg-white text-brand border border-black hover:bg-gray-50">
                ➕ Ajouter
              </button>
              <div class="ml-auto text-sm grid gap-1">
                <div>Conso/jour : <strong id="grid_kwh_day">0.00</strong> kWh</div>
                <div>Durée estimée : <strong id="grid_days">—</strong></div>
                <div id="grid_cost" class="opacity-80">Coût/jour : —</div>
              </div>
            </div>
          </div>
        </section>

        <!-- ===================== SOLAIRE (PV + BAT) ===================== -->
        <section id="panel-pv" class="sim-panel hidden grid gap-4">
          <header class="flex items-center justify-between gap-3 flex-wrap">
            <h3 class="text-xl font-bold text-yellowBrand">Solaire — Production & autonomie</h3>
            <div id="pv_status" class="px-2 py-1 rounded border text-sm bg-white/10 border-white/30" aria-live="polite">—</div>
          </header>

          <div class="bg-white text-ink dark:bg-[#111827] dark:text-white rounded-xl border border-gray-200 dark:border-slate-700 p-5 shadow-card grid gap-4">
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3">
              <label class="grid gap-1">
                <span class="font-semibold">Panneaux</span>
                <div class="flex gap-2">
                  <input id="pv_n" type="number" value="2" min="0"
                         class="w-20 p-3 rounded-lg border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-800">
                  <span class="self-center">×</span>
                  <input id="pv_w" type="number" value="450" min="0"
                         class="w-24 p-3 rounded-lg border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-800"><span class="self-center">W</span>
                </div>
                <small class="opacity-70">Ex: 2×450 W</small>
              </label>
            </div>

            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3">
              <label class="grid gap-1">
                <span class="font-semibold">Batterie — Tension (V)</span>
                <input id="pv_v" type="number" value="24" min="0"
                       class="w-full p-3 rounded-lg border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-800">
                <small class="opacity-70">Ex: 2×12 V en série → 24 V</small>
              </label>
              <label class="grid gap-1">
                <span class="font-semibold">Capacité (Ah)</span>
                <input id="pv_ah" type="number" value="100" min="0"
                       class="w-full p-3 rounded-lg border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-800">
                <small class="opacity-70">Ah du pack total</small>
              </label>
              <label class="grid gap-1">
                <span class="font-semibold">Onduleur ou Convertisseur (kW)</span>
                <input id="pv_invkw" type="number" step="0.1" value="3" min="0"
                       class="w-full p-3 rounded-lg border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-800">
                <small class="opacity-70">Ex: hybride 3 kW</small>
              </label>
            </div>

            <!-- Catalogue rapide (vignettes) — PV -->
            <details class="rounded border border-gray-200/60 dark:border-slate-700 p-3">
              <summary class="cursor-pointer font-semibold">Catalogue rapide (vignettes)</summary>
              <div id="pv_catalog" class="mt-3 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 xl:grid-cols-5 gap-3"></div>
            </details>

            <!-- Tableau équipements PV -->
            <div class="-mx-3 sm:mx-0 overflow-x-auto">
              <table class="min-w-[640px] w-full text-sm">
                <thead>
                  <tr class="text-left text-gray-600 dark:text-gray-300">
                    <th class="py-2">Équipement</th><th>W</th><th>h/j</th><th></th>
                  </tr>
                </thead>
                <tbody id="pv_rows"></tbody>
              </table>
            </div>

            <div class="flex flex-wrap gap-2">
              <button id="pv_add"
                class="inline-flex items-center justify-center px-3 py-2 rounded-lg font-semibold transition shadow-card
                       bg-white text-brand border border-black hover:bg-gray-50">
                ➕ Ajouter
              </button>
              <div class="ml-auto text-sm grid gap-1">
                <div>Prod. PV/jour : <strong id="pv_kwh_prod">0.00</strong> kWh</div>
                <div>Conso/jour : <strong id="pv_kwh_day">0.00</strong> kWh</div>
                <div>Solde/jour : <strong id="pv_kwh_balance">—</strong></div>
                <div>Autonomie batterie (toutes charges en même temps) : <strong id="pv_runtime">—</strong></div>
              </div>
            </div>
          </div>
        </section>

        <!-- ===================== GROUPE ÉLECTROGÈNE ===================== -->
        <section id="panel-gen" class="sim-panel hidden grid gap-4">
          <header class="flex items-center justify-between gap-3 flex-wrap">
            <h3 class="text-xl font-bold text-yellowBrand">Groupe — Puissance & durée</h3>
            <div id="gen_status" class="px-2 py-1 rounded border text-sm bg-white/10 border-white/30" aria-live="polite">—</div>
          </header>

          <div class="bg-white text-ink dark:bg-[#111827] dark:text-white rounded-xl border border-gray-200 dark:border-slate-700 p-5 shadow-card grid gap-4">
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3">
              <label class="grid gap-1">
                <span class="font-semibold">Puissance groupe (kVA)</span>
                <input id="gen_kva" type="number" step="0.1" value="5.5" min="0"
                       class="w-full p-3 rounded-lg border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-800">
                <small class="opacity-70">Ex: 5,5 kVA</small>
              </label>
            </div>

            <details class="rounded border border-gray-200/60 dark:border-slate-700 p-3">
              <summary class="cursor-pointer font-semibold">Options carburant — Estimer le temps de marche</summary>
              <div class="mt-3 grid grid-cols-1 sm:grid-cols-2 gap-3">
                <label class="grid gap-1">
                  <span class="font-semibold">Type de carburant</span>
                  <select id="gen_type"
                          class="w-full p-3 rounded-lg border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-800">
                    <option value="diesel">Diesel</option>
                    <option value="essence">Essence</option>
                  </select>
                  <small class="opacity-70">Influe sur la conso estimée (Auto)</small>
                </label>

                <label class="grid gap-1">
                  <span class="font-semibold">Mode de calcul</span>
                  <label class="inline-flex items-center gap-2">
                    <input id="gen_auto" type="checkbox" class="rounded" checked>
                    <span>Auto (selon charge)</span>
                  </label>
                  <small class="opacity-70">Décochez pour saisir la conso manuellement</small>
                </label>

                <label class="grid gap-1">
                  <span class="font-semibold">Réservoir (L)</span>
                  <input id="gen_tank" type="number" step="0.1" value="15" min="0"
                         class="w-full p-3 rounded-lg border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-800">
                </label>

                <label class="grid gap-1">
                  <span class="font-semibold">Conso moyenne (L/h)</span>
                  <input id="gen_fuel" type="number" step="0.1" value="1.5" min="0"
                         class="w-full p-3 rounded-lg border border-gray-300 dark:border-slate-600 bg-white dark:bg-slate-800"
                         placeholder="ex: 1.5 (mode manuel)">
                  <small class="opacity-70">Actif seulement si Auto est décoché</small>
                </label>
              </div>
            </details>

            <!-- Catalogue rapide (vignettes) — Groupe -->
            <details class="rounded border border-gray-200/60 dark:border-slate-700 p-3">
              <summary class="cursor-pointer font-semibold">Catalogue rapide (vignettes)</summary>
              <div id="gen_catalog" class="mt-3 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 xl:grid-cols-5 gap-3"></div>
            </details>

            <!-- Tableau équipements GEN -->
            <div class="-mx-3 sm:mx-0 overflow-x-auto">
              <table class="min-w-[700px] w-full text-sm">
                <thead>
                  <tr class="text-left text-gray-600 dark:text-gray-300">
                    <th class="py-2">Équipement</th><th>W</th><th>Facteur de pic</th><th></th>
                  </tr>
                </thead>
                <tbody id="gen_rows"></tbody>
              </table>
            </div>

            <div class="flex flex-wrap gap-2">
              <button id="gen_add"
                class="inline-flex items-center justify-center px-3 py-2 rounded-lg font-semibold transition shadow-card
                       bg-white text-brand border border-black hover:bg-gray-50">
                ➕ Ajouter
              </button>
              <div class="ml-auto text-sm grid gap-1">
                <div>Budget continu (80% par défaut) : <strong id="gen_budget">— W</strong></div>
                <div>Charge en régime : <strong id="gen_run">—</strong>W</div>
                <div>Pic au démarrage : <strong id="gen_peak">—</strong>W</div>
                <div>Autonomie (si réservoir/consommation fournis) : <strong id="gen_runtime">—</strong></div>
                <div>Conso estimée : <strong id="gen_lph">—</strong></div>
              </div>
            </div>
          </div>
        </section>

      </div>
    </div>
  </section>

  <!-- Footer injecté -->
  <div data-include="partials/footer.html"></div>

  <!-- Scripts -->
  <script type="module" src="js/inject.js"></script>
  <script src="js/main.js" defer></script>
  <script src="js/simulateurs.js" defer></script>
</body>
</html>
